{
  "info": {
    "_postman_id": "a44c86f0-a7ab-4d17-afe0-d0d5ab393b91",
    "name": "Automations: API-First Workflows",
    "description": "Workflow **automations** for API-first design, development, testing, publishing, and discovery.",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "name": "Request External Schema",
      "event": [
        {
          "listen": "test",
          "script": {
            "id": "a0986f41-99e2-4caa-a541-f169c97ac627",
            "exec": [
              "let schemaWithNewlines = pm.response.text()",
              "const newLineRegex = /\\n/g",
              "let schemaWithoutNewlines = schemaWithNewlines.replace(newLineRegex, '\\\\n')",
              "const doubleQuoteRegex = /\\\"/g",
              "let schemaWithoutNewlinesOrQuotes = schemaWithoutNewlines.replace(doubleQuoteRegex, '\\\\\"')",
              "const escapeTheEscapes = /\\\\\\\\/g",
              "let escapedEscapes = schemaWithoutNewlinesOrQuotes.replace(escapeTheEscapes, '\\\\\\\\\\\\')",
              "",
              "pm.environment.set('schema', escapedEscapes)",
              "",
              "console.log(escapedEscapes)"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "id": "c4ef8fd4-34b1-41a9-afed-8e06cfad6ba5",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": "{{external-schema-url}}"
      },
      "response": []
    },
    {
      "name": "Update Schema To Retrieved Spec",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "e09e6aa2-d1e8-423b-8401-77a918f01208",
            "exec": [
              "pm.collectionVariables.set('retrievedSchema', pm.environment.get('schema'))",
              "",
              "console.log('------------------------')",
              "console.log(pm.collectionVariables.get('retrievedSchema'))",
              "console.log('^^^retrieved schema^^^')",
              "console.log('========================')",
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "id": "ff08bf73-8412-4a9c-b250-e040ee79d0ab",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [
          {
            "name": "Content-Type",
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"schema\": {\n\t\t\"language\": \"{{specLanguage}}\",\n\t\t\"schema\": \"{{retrievedSchema}}\",\n\t\t\"type\": \"{{specType}}\"\n\t}\n}"
        },
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/schemas/{{schemaId}}",
        "description": "This call updates an existing schema.\n\nRequest body should contain a `schema` object which should atleast have these properties with `string` values:\n\n- **`type`**: Allowed types are `openapi3`, `openapi2`, `openapi1`, `raml` and `graphql`.\n- **`language`** : Allowed languages are `json` and `yaml` for OpenAPI and RAML schema types. GraphQL schema type accepts only `graphql` language.\n- **`schema`**: Optional. If passed, must be the content of the schema as a `string`.\n\nResponse contains a `schema` object with all the details related to the created schema, namely, `id`, `language`, `type` etc. \n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "37531333-f1b8-4349-a8c6-6ce3742bd7b5",
          "name": "Update Schema To Retrieved Spec",
          "originalRequest": {
            "method": "PUT",
            "header": [
              {
                "name": "Content-Type",
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n\t\"schema\": {\n\t\t\"language\": \"yaml\",\n\t\t\"schema\": \"{{retrievedSchema}}\",\n\t\t\"type\": \"openapi3_1\"\n\t}\n}"
            },
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/schemas/{{schemaId}}"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:40:24 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=138025f9cb90d4f9"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=a74575ed5d19c3c4"
            },
            {
              "key": "ETag",
              "value": "W/\"10e-XHsBATQrJ8o+Sq0TyPhgVEZNYJU\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "key": "Content-Encoding",
              "value": "gzip"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"schema\": {\n        \"id\": \"dfdb7c7e-ab6b-4a92-b34c-b9530240798c\",\n        \"type\": \"openapi3_1\",\n        \"language\": \"yaml\",\n        \"createdBy\": \"15950784\",\n        \"updatedBy\": \"15950784\",\n        \"createdAt\": \"2022-03-07T18:29:35.000Z\",\n        \"updatedAt\": \"2022-03-07T19:40:23.000Z\",\n        \"apiVersion\": \"f6f8414c-cc59-48de-9796-f72e7f6db4d1\"\n    }\n}"
        }
      ]
    },
    {
      "name": "Sync Documentation with Schema",
      "id": "881f7789-1609-4073-b59f-cbb5119c9aaf",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "9a6c3f40-2054-40c6-8f9b-6cd4dd60cc11",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    },
    {
      "name": "Sync Mock with Schema",
      "id": "256e6ee7-bfac-43c8-a759-b14606061144",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/mock/{{mockEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "c73b9e07-88af-42f0-922a-c655ddb408f3",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    },
    {
      "name": "Sync Smoke Test Monitor with Schema",
      "id": "d2150cde-2917-4067-92ae-3f25e004c019",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/monitor/{{monitorEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "9e6db711-6910-4fe6-9669-753e4f802221",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    }
  ],
  "auth": {
    "type": "apikey",
    "apikey": {
      "value": "{{postman-api-key}}",
      "key": "X-API-Key"
    }
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "ac15f547-5064-4d23-b2af-2f9c05b06aa3",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "cf9dfd2a-a45d-4610-a29b-76c0a87fdef3",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "id": "84030d44-a7c6-442f-9f94-38673421fb12",
      "key": "retrievedSchema",
      "value": ""
    }
  ]
}