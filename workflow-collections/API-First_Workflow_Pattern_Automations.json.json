{
  "info": {
    "_postman_id": "445e05e3-4cd6-4c93-996f-e8a6cfbd1861",
    "name": "API-First Workflow Pattern Automations",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "name": "Request External Schema",
      "event": [
        {
          "listen": "test",
          "script": {
            "id": "a0986f41-99e2-4caa-a541-f169c97ac627",
            "exec": [
              "let schemaWithNewlines = pm.response.text()",
              "const newLineRegex = /\\n/g",
              "let schemaWithoutNewlines = schemaWithNewlines.replace(newLineRegex, '\\\\n')",
              "const doubleQuoteRegex = /\\\"/g",
              "let schemaWithoutNewlinesOrQuotes = schemaWithoutNewlines.replace(doubleQuoteRegex, '\\\\\"')",
              "const escapeTheEscapes = /\\\\\\\\/g",
              "let escapedEscapes = schemaWithoutNewlinesOrQuotes.replace(escapeTheEscapes, '\\\\\\\\\\\\')",
              "",
              "pm.environment.set('schema', escapedEscapes)",
              "",
              "console.log(escapedEscapes)"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "_postman_id": "84885ccc-b983-4a14-9ba7-651d529fcf23",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": "{{external-schema-url}}"
      },
      "response": []
    },
    {
      "name": "Update Schema To Retrieved Spec",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "e09e6aa2-d1e8-423b-8401-77a918f01208",
            "exec": [
              "pm.collectionVariables.set('retrievedSchema', pm.environment.get('schema'))",
              "",
              "console.log('------------------------')",
              "console.log(pm.collectionVariables.get('retrievedSchema'))",
              "console.log('^^^retrieved schema^^^')",
              "console.log('========================')",
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "_postman_id": "bfc78334-322d-4030-99f4-6c4aa64d41a2",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [
          {
            "name": "Content-Type",
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"schema\": {\n\t\t\"language\": \"{{specLanguage}}\",\n\t\t\"schema\": \"{{retrievedSchema}}\",\n\t\t\"type\": \"{{specType}}\"\n\t}\n}",
          "options": {
            "raw": {}
          }
        },
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/schemas/{{schemaId}}",
        "description": "This call updates an existing schema.\n\nRequest body should contain a `schema` object which should atleast have these properties with `string` values:\n\n- **`type`**: Allowed types are `openapi3`, `openapi2`, `openapi1`, `raml` and `graphql`.\n- **`language`** : Allowed languages are `json` and `yaml` for OpenAPI and RAML schema types. GraphQL schema type accepts only `graphql` language.\n- **`schema`**: Optional. If passed, must be the content of the schema as a `string`.\n\nResponse contains a `schema` object with all the details related to the created schema, namely, `id`, `language`, `type` etc. \n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "32cadaef-6770-4507-9627-2164de848013",
          "name": "Update Schema To Retrieved Spec",
          "originalRequest": {
            "method": "PUT",
            "header": [
              {
                "name": "Content-Type",
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n\t\"schema\": {\n\t\t\"language\": \"yaml\",\n\t\t\"schema\": \"{{retrievedSchema}}\",\n\t\t\"type\": \"openapi3_1\"\n\t}\n}",
              "options": {
                "raw": {}
              }
            },
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/schemas/{{schemaId}}"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:40:24 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Transfer-Encoding",
              "value": "chunked"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=138025f9cb90d4f9"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=a74575ed5d19c3c4"
            },
            {
              "key": "ETag",
              "value": "W/\"10e-XHsBATQrJ8o+Sq0TyPhgVEZNYJU\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            },
            {
              "key": "Content-Encoding",
              "value": "gzip"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"schema\": {\n        \"id\": \"dfdb7c7e-ab6b-4a92-b34c-b9530240798c\",\n        \"type\": \"openapi3_1\",\n        \"language\": \"yaml\",\n        \"createdBy\": \"15950784\",\n        \"updatedBy\": \"15950784\",\n        \"createdAt\": \"2022-03-07T18:29:35.000Z\",\n        \"updatedAt\": \"2022-03-07T19:40:23.000Z\",\n        \"apiVersion\": \"f6f8414c-cc59-48de-9796-f72e7f6db4d1\"\n    }\n}"
        }
      ]
    },
    {
      "name": "Sync Documentation with Schema",
      "_postman_id": "a0d068b8-9f05-4bdc-a1d5-57efd1ea85f4",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "0e732a40-d681-41e8-9255-98f653813bd0",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    },
    {
      "name": "Sync Mock with Schema",
      "_postman_id": "ab8b3dd6-c666-4bce-b82a-cbf9151d779d",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/mock/{{mockEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "73d1bb61-8664-4fa3-95f7-82707db9d837",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    },
    {
      "name": "Sync Smoke Test Monitor with Schema",
      "_postman_id": "9c8553f9-ccf4-4ab7-a252-1c9b726b1208",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "PUT",
        "header": [],
        "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/monitor/{{monitorEntityId}}/syncWithSchema",
        "description": "This call allows you to keep the relation in sync with the API schema.\n\n\n> Requires <a href=\"#authentication\">API Key</a> as `X-Api-Key` request header or `apikey` URL query parameter."
      },
      "response": [
        {
          "id": "84d63acf-9ac9-46c1-8e93-13d5f209e285",
          "name": "Sync Documentation with Schema",
          "originalRequest": {
            "method": "PUT",
            "header": [],
            "url": "https://api.getpostman.com/apis/{{apiId}}/versions/{{apiVersionId}}/documentation/{{documentationEntityId}}/syncWithSchema"
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Date",
              "value": "Mon, 07 Mar 2022 19:45:10 GMT"
            },
            {
              "key": "Content-Type",
              "value": "application/json; charset=utf-8"
            },
            {
              "key": "Content-Length",
              "value": "16"
            },
            {
              "key": "Connection",
              "value": "keep-alive"
            },
            {
              "key": "Server",
              "value": "nginx"
            },
            {
              "key": "x-frame-options",
              "value": "SAMEORIGIN"
            },
            {
              "key": "Access-Control-Allow-Origin",
              "value": "*"
            },
            {
              "key": "x-srv-trace",
              "value": "v=1;t=7f9a1a1793aff2af"
            },
            {
              "key": "x-srv-span",
              "value": "v=1;s=fb2bde0e595b29cb"
            },
            {
              "key": "ETag",
              "value": "W/\"10-oV4hJxRVSENxc/wX8+mA4/Pe4tA\""
            },
            {
              "key": "Vary",
              "value": "Accept-Encoding"
            }
          ],
          "cookie": [],
          "responseTime": null,
          "body": "{\n    \"success\": true\n}"
        }
      ]
    }
  ],
  "auth": {
    "type": "apikey",
    "apikey": {
      "value": "{{postman-api-key}}",
      "key": "X-API-Key"
    }
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "ac15f547-5064-4d23-b2af-2f9c05b06aa3",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "cf9dfd2a-a45d-4610-a29b-76c0a87fdef3",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "id": "00ea3ff7-994c-405a-96d9-27cec459ba88",
      "key": "retrievedSchema",
      "value": "",
      "type": "string"
    }
  ]
}